"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7054],{7054:function(e,n,r){r.d(n,{Fk:function(){return J},PH:function(){return K}});var s=r(95235),a=r(2784),l=r(27959),i=r(85223),t=r(10866),d=r(82445),c=r(46099),o=r(60543),x=r(87660),m=r(36335),u=r(5632),h=r(72004),p=r(72456),_=r(71697),j="\npx-4\nflex\nflex-row\njustify-between\nh-8\n",f="\nflex\nitems-center\nh-min\nmy-2.5\n",v="\nw-32\nflex\nitems-center\njustify-center\nmy-2.5\ntext-lg\n",b=function(e){var n=e.key;/[-e.]/.test(n)&&"ArrowLeft"!==n&&"ArrowRight"!==n&&"ArrowUp"!==n&&"ArrowDown"!==n&&"Backspace"!==n&&e.preventDefault()},y=r(25592),g=r(64566),N=r(5864),w=r(30537),O=r(9261),S=r(52322),k={id:m.e.OrderReview,position:"start",title:"Review Order"},I=function(){var e=(0,o.Z)("module_order"),n=(0,O.xw)(),r=n.isLoading,s=n.isError,a=n.error,l=n.handleConfirmation,i=n.orderIsProcessing,d=n.stagePrefix;return(0,S.jsxs)("div",{className:"\nh-full\nw-full\nmd:w-[400px]\nrelative\n",children:[(0,S.jsxs)("div",{className:"\nfont-mori \nw-full \nflex\nflex-col\n",children:[(0,S.jsx)("div",{className:"mb-[17.5px]",children:(0,S.jsx)(t.iz,{})}),(0,S.jsxs)("div",{children:[(0,S.jsx)(N.M,{error:a,isError:s}),(0,S.jsx)(g.S,{}),(0,S.jsx)(w.P,{})]}),(0,S.jsx)("div",{className:"mt-4",children:(0,S.jsx)(t.iz,{})}),(0,S.jsxs)("div",{className:"\n",children:[(0,S.jsx)("div",{className:"".concat("\nmy-5\nmx-4\n"),children:(0,S.jsx)("div",{className:"mt-4",children:(0,S.jsx)(t.zx,{fullWidth:!0,label:e("review_order_modal.".concat(d,".complete_button")),loading:r,onClick:l})})}),(0,S.jsxs)("div",{className:"".concat("\nflex\nflex-col\njustify-between\nmx-4\nmt-4\nmb-4\ngap-y-[8px]\n"),children:[(0,S.jsx)(t.xv,{label:e("review_order_modal.".concat(d,".disclaimer.title")),type:"h6"}),(0,S.jsx)("div",{className:"h-full",children:(0,S.jsx)(t.xv,{label:e("review_order_modal.".concat(d,".disclaimer.body")),markdown:!0,type:"p4"})})]})]})]}),i&&(0,S.jsxs)("div",{className:"\nflex\nflex-col\nbg-white\nabsolute\nh-full\nw-full\ntop-0\nleft-0\njustify-center\nitems-center\n",children:[(0,S.jsx)(t.$j,{size:"xl"}),(0,S.jsx)("div",{className:"mt-4",children:e("review_order_modal.loading_message")})]})]})},E=r(20406),A=r(82841),R=r.n(A),C="\npx-4\nflex\nflex-row\njustify-between\nmb-3\nh-8\n",z="\ntext-back\ntext-sm\nfont-mori\ntext-center\n[&>a>div]:inline-flex\n",P=function(e){var n,r,s=e.order,d=e.redirect,c=e.user,x=(0,u.useRouter)().push,m=(0,o.Z)("module_order"),p=(0,a.useState)(),_=p[0],j=p[1];(0,a.useEffect)(function(){j((0,i.Am)(c))},[c]);var f=(n=(0,E.Z)(R().mark(function e(){return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.np)("signInClick");case 2:return e.next=4,x("".concat(m("order_card.signed_out_message.2/5.link"),"?redirect=").concat(d));case 4:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)}),v=(r=(0,E.Z)(R().mark(function e(){return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.np)("createCtaModal",{pagePath:d});case 2:return e.next=4,x("".concat(m("order_card.signed_out_message.4/5.link"),"?redirect=").concat(d));case 4:case"end":return e.stop()}},e)})),function(){return r.apply(this,arguments)});return _?(null==_?void 0:_.step)===l.OnboardingStep.SignedOut?(0,S.jsx)("div",{className:C,children:(0,S.jsxs)("div",{className:z,children:[m("order_card.signed_out_message.1/5"),(0,S.jsx)(t.rU,{label:m("order_card.signed_out_message.2/5.label"),onClick:f,path:"".concat(m("order_card.signed_out_message.2/5.link"),"?redirect=").concat(d)}),m("order_card.signed_out_message.3/5"),(0,S.jsx)(t.rU,{label:m("order_card.signed_out_message.4/5.label"),onClick:v}),m("order_card.signed_out_message.5/5")]})}):(null==_?void 0:_.step)===l.OnboardingStep.ContactInfo?(0,S.jsx)("div",{className:C,children:(0,S.jsxs)("div",{className:z,children:[m("order_card.finish_your_account.1/3"),(0,S.jsx)(t.rU,{label:m("order_card.finish_your_account.2/3"),path:"".concat(null==_?void 0:_.path)}),m("order_card.finish_your_account.3/3")]})}):(null==_?void 0:_.step)===l.OnboardingStep.BankingLink?(0,S.jsx)("div",{className:C,children:(0,S.jsxs)("div",{className:z,children:[m("order_card.finish_bank_linking.1/3"),(0,S.jsx)(t.rU,{label:m("order_card.finish_bank_linking.2/3"),path:"".concat(null==_?void 0:_.path)}),m("order_card.finish_bank_linking.3/3")]})}):(0,S.jsx)("div",{className:"\npx-4\nflex\nflex-col\nitems-center\njustify-center\n",children:(null==s?void 0:s.is_remaining_shares_one_percent_or_less)&&(0,S.jsx)(t.xv,{label:m("order_card.low_availability_message"),type:"p4",weight:"normal"})}):null},Z=r(34063),T="\nmx-5\n",D={id:m.e.OrderAbandon,isCloseable:!1,position:"start",title:"Your Order is incomplete"},V=function(){var e=(0,o.Z)("module_order"),n=(0,m.Z)(),r=n.closeModal,s=n.showModalById,l=(0,a.useState)(!1),i=l[0],d=l[1],c="string"==typeof e("abandon_order_modal.body")?[e("abandon_order_modal.body")]:e("abandon_order_modal.body"),x=(0,O.xw)(),u=x.isLoading,h=x.isError,p=x.error,_=x.handleConfirmation,j=x.orderIsProcessing,f=x.stagePrefix,v=x.canConfirm,b=function(){v?_():s(m.e.OrderAgreements)};return(0,S.jsxs)("div",{className:"\nh-full\nw-full\nmd:w-[400px]\nrelative\n",children:[(0,S.jsxs)("div",{className:"\nfont-mori \nw-full \nflex\nflex-col\n",children:[(0,S.jsx)("div",{className:"mb-[17.5px]",children:(0,S.jsx)(t.iz,{})}),(0,S.jsx)("div",{className:T,children:c.map(function(e,n){return(0,S.jsx)("div",{className:"mb-4",children:(0,S.jsx)(t.xv,{label:e,markdown:!0,type:"p2"})},"abandon_order_body_".concat(n))})}),(0,S.jsxs)("div",{children:[h&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:"mb-[17.5px]",children:(0,S.jsx)(t.iz,{})}),(0,S.jsx)(N.M,{error:p,isError:h})]}),(0,S.jsxs)("div",{className:i?(0,Z.JF)("\nopacity-100\nh-[225px]\n",T):(0,Z.JF)("\nopacity-0\nh-0\noverflow-hidden\n",T),style:{transition:"height 0.3s, opacity 0.3s"},children:[(0,S.jsxs)("div",{className:"my-[17.5px]",children:[(0,S.jsx)(t.xv,{label:"Order Details",type:"h6"}),(0,S.jsx)(t.iz,{})]}),(0,S.jsx)(w.P,{})]}),(0,S.jsx)("div",{className:"\nmy-5\nmx-4\n",children:(0,S.jsx)(t.zx,{fullWidth:!0,label:e(i?"abandon_order_modal.hide_order_details":"abandon_order_modal.view_order_details"),onClick:function(){return d(!i)},type:"tertiary"})})]}),(0,S.jsx)("div",{className:"mt-4",children:(0,S.jsx)(t.iz,{})}),(0,S.jsx)("div",{className:T,children:(0,S.jsxs)("div",{className:"".concat("\nflex\njustify-around\nfull-width\nmt-4\n"),children:[(0,S.jsx)("div",{className:"mb-3",children:(0,S.jsx)(t.zx,{label:e("abandon_order_modal.cancel_button_label"),loading:u,onClick:function(){return r(D.id)},type:"tertiary"})}),(0,S.jsx)("div",{className:"mb-3",children:(0,S.jsx)(t.zx,{label:e(v?"review_order_modal.".concat(f,".complete_button"):"abandon_order_modal.continue_button_label"),loading:u,onClick:function(){return b()}})})]})})]}),j&&(0,S.jsxs)("div",{className:"\nflex\nflex-col\nbg-white\nabsolute\nh-full\nw-full\ntop-0\nleft-0\njustify-center\nitems-center\n",children:[(0,S.jsx)(t.$j,{size:"xl"}),(0,S.jsx)("div",{className:"mt-4",children:e("review_order_modal.loading_message")})]})]})};function M(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function U(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?M(Object(r),!0).forEach(function(n){(0,s.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var J=function(){var e=(0,u.useRouter)(),n=e.asPath,r=e.isReady,s=(0,a.useState)(""),g=s[0],N=s[1],w=(0,a.useState)(!1),O=w[0],E=w[1],A=(0,x.Z)(),R=A.data,C=A.setOrderData,z=A.isOrderSubmitted,Z=A.setIsOrderSubmitted,T=!(null!=R&&R.is_remaining_shares_one_percent_or_less),M=(0,m.Z)(),J=M.showModal,W=M.closeModal,B=(0,o.Z)("module_order"),F=(0,c.Z)("currency"),L=(0,d.TA)({initialValues:{shares:void 0},onSubmit:function(){}}),K=R.current_share_price,Y=R.asset_issuance_stage,$=R.stage_prefix,q=R.order_id,H=R.asset_id,G=R.order_type,Q=Y===l.AssetIssuanceStage.RESERVATION?l.OrderType.RESERVE:l.OrderType.BUY,X=L.values.shares,ee=(0,i.ZP)().user;(0,a.useEffect)(function(){O&&(E(!1),J((0,S.jsx)(V,{}),D))},[O]);var en=(0,_.Db)(l.createOrder,{mutationId:l.createOrderId,onSuccess:function(e){Y===l.AssetIssuanceStage.RESERVATION&&(0,h.np)("reservationSharesConfirmation",{orderId:null==e?void 0:e.order_id,price:null!=K?K:0,productId:H||"",shares:null!=X?X:0,totalPrice:K&&X?F(X*K):0}).then(),C({asset_id:H,current_share_price:K,order_id:e.order_id,order_type:G,shares:X}),q&&Y===l.AssetIssuanceStage.PRIMARY_ISSUANCE||!(null!=R&&R.plaid_account_id)?J((0,S.jsx)(y.bc,{}),U(U({},y.K1),{},{onClose:function(){return E(!0),!1}})):J((0,S.jsx)(I,{}),k)}}),er=en.mutate,es=en.isLoading,ea=function(){void 0!==X?(L.handleSubmit(),C({asset_id:R.asset_id,current_share_price:K,order_id:q,order_type:Q,shares:X}),X>0?(Z(!1),er({asset_id:H,order_type:Q,shares:null!=X?X:0})):(0,p.j)("order-card-no-shares",{email:ee.email,shares:X})):(0,p.j)("order-card-no-form-state",{email:ee.email})},el=(null!=X?X:0)*K,ei=Object.keys((null==L?void 0:L.errors)||{}).length>0,et=void 0!==X&&X>0,ed=(0,i.Am)(ee).step===l.OnboardingStep.Onboarded,ec=!!R.asset_id;return(0,a.useEffect)(function(){return function(){return W()}},[]),(0,a.useEffect)(function(){r&&N(n&&n)},[r]),(0,S.jsx)("div",{className:"\n[&>div]:p-0\n\n",children:(0,S.jsx)(t.Zb,{children:(0,S.jsx)("div",{className:"\nlg:w-[312px]\nh-auto\n",children:(0,S.jsxs)("div",{className:"\npy-4\nrelative\nflex\nflex-col\nw-full\nh-full\nshadow-inner\n",children:[(0,S.jsxs)("div",{className:"px-4 flex h-[30px]",children:[Y===l.AssetIssuanceStage.RESERVATION&&(0,S.jsxs)(S.Fragment,{children:[" ",(0,S.jsx)("div",{className:f,children:(0,S.jsx)(t.xv,{color:"black",label:B("order_card.".concat($,".header_title")),type:"h6"})}),(0,S.jsx)("div",{className:"ml-[4px] mb-1",children:(0,S.jsx)(t.u,{content:B("order_card.".concat($,".header_tooltip")),placement:"bottom-start",children:(0,S.jsx)(t.JO,{color:"gray-4",name:"info",size:"s"})})})]}),Y===l.AssetIssuanceStage.PRIMARY_ISSUANCE&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:v,children:(0,S.jsx)(t.zx,{fullWidth:!0,label:B("order_card.order_type.buy"),onClick:function(){},size:"l",type:"tab"})}),(0,S.jsx)("div",{className:"".concat(v),children:(0,S.jsx)(t.zx,{disabled:!0,fullWidth:!0,label:B("order_card.order_type.sell"),onClick:function(){},size:"l",type:"tertiary"})}),(0,S.jsx)("div",{className:"ml-[4px] mb-1",children:(0,S.jsx)(t.u,{content:B("order_card.".concat($,".header_tooltip")),children:(0,S.jsx)(t.JO,{color:"gray-4",name:"info",size:"s"})})})]})]}),(0,S.jsxs)("div",{className:"flex w-full",children:[(0,S.jsx)("hr",{className:"\nmx-[-4]\nmy-[17.5px]\nh-[2px]\nw-1/2 text-blue\n"}),(0,S.jsx)("hr",{className:"\nmx-[-4]\nmy-[17.5px]\nh-[1px]\ntext-gray-2\nw-1/2\n"})]}),(0,S.jsxs)("div",{className:j,children:[(0,S.jsx)("div",{className:f,children:(0,S.jsx)(t.xv,{color:"gray-4",label:B("order_card.form.share"),type:"p4"})}),(0,S.jsx)("div",{className:"\nw-[140px]\nh-10\nz-basic\n",children:(0,S.jsx)(t.Ki,{id:"shares",min:1,onChange:L.handleChange,onKeyDown:b,placeholder:"",step:1})})]}),(0,S.jsx)("hr",{className:"\nmx-[-4]\nmy-[17.5px]\nh-[1px]\ntext-gray-1\n"}),(0,S.jsxs)("div",{className:j,children:[(0,S.jsxs)("div",{className:f,children:[(0,S.jsx)(t.xv,{color:"gray-4",label:B("order_card.form.price.label"),type:"p4"}),(0,S.jsx)("div",{className:"mb-[5px]",children:(0,S.jsx)(t.u,{content:B("order_card.form.price.tooltip"),children:(0,S.jsx)("div",{className:"ml-[4px]",children:(0,S.jsx)(t.JO,{color:"gray-4",name:"info",size:"s"})})})})]}),(0,S.jsx)("div",{className:f,children:(0,S.jsx)(t.xv,{label:F(K),type:"p3"})})]}),(0,S.jsx)("hr",{className:"\nmx-[-4]\nmy-[17.5px]\nh-[1px]\ntext-gray-2\n"}),(0,S.jsxs)("div",{className:"".concat("\npx-4\nflex\nflex-row\njustify-between\nmb-3\nh-8\n"),children:[(0,S.jsx)("div",{className:f,children:(0,S.jsx)(t.xv,{label:B("order_card.form.total"),type:"p4",weight:"semi-bold"})}),(0,S.jsx)("div",{className:f,children:(0,S.jsx)(t.xv,{label:F(el),type:"p3",weight:"semi-bold"})})]}),(0,S.jsx)("div",{className:"\npx-4\nmt-[22px]\nmb-3\n",children:T?(0,S.jsx)(t.zx,{disabled:ei||!ed||!ec||!et,fullWidth:!0,label:B("order_card.".concat($,".button")),loading:es,onClick:ea}):(0,S.jsx)(t.zx,{disabled:!0,fullWidth:!0,label:B("order_card.sold_out"),onClick:ea,type:"secondary"})}),q&&z&&(0,S.jsxs)("div",{className:"flex flex-row items-center mx-4 mb-4",children:[(0,S.jsx)(t.JO,{color:"yellow",name:"triangleExclamation",size:"xl"}),(0,S.jsx)("div",{className:"ml-2",children:(0,S.jsx)(t.xv,{label:B("order_card.can_duplicate_order"),type:"p4"})})]}),(0,S.jsx)(P,{order:R,redirect:g,user:ee})]})})})})};r(20213),r(51430),r(8973);var W="\npx-4\nflex\nflex-row\njustify-between\nh-8\n",B="\npx-4\nflex\nflex-row\njustify-between\nmb-3\n",F="\nflex\ngap-1\nitems-center\nh-min\nmy-2.5\n",L=function(){var e=(0,x.Z)().data.song_title||"N/A";return(0,S.jsx)("div",{className:"\nflex\nflex-col\nw-full\npl-4\npb-9\n",children:(0,S.jsx)(t.xv,{label:e,type:"h6",weight:"normal"})})},K=function(e){e.orderType;var n,r,s,p=(0,a.useState)(!1),j=p[0],f=p[1],v=(0,a.useState)(""),y=v[0],g=v[1],N=(0,o.Z)("module_order"),w=(0,u.useRouter)(),O=w.isReady,E=w.asPath,A=(0,m.Z)().showModal,R=(0,i.ZP)().availableBalance,C=(0,i.ZP)().user,z=(0,x.Z)(),Z=z.data,T=z.setOrderData,D=z.setOrderAndAgreementID,V=(0,c.Z)("currency"),M=Z.current_share_price,U=Z.asset_issuance_stage,J=Z.asset_id,K=Z.shares,Y=U===l.AssetIssuanceStage.RESERVATION?l.OrderType.RESERVE:l.OrderType.BUY,$=(0,d.TA)({initialValues:{shares:void 0},onSubmit:function(){}}),q=null!==(n=$.values.shares)&&void 0!==n?n:0,H=(0,_.Db)(l.createOrder,{mutationId:l.createOrderId,onSuccess:function(){U===l.AssetIssuanceStage.RESERVATION&&(0,h.np)("reservationSharesConfirmation",{orderId:null==X?void 0:X.order_id,price:null!=M?M:0,productId:J||"",shares:null!=K?K:0,totalPrice:M&&K?V(K*M):0})}}),G=H.mutate,Q=H.isLoading,X=H.data,ee=(0,_.aM)(l.getOrder,{enabled:(null==X?void 0:X.order_id)!==void 0,onSuccess:function(){f(!0)},params:{orderId:null==X?void 0:X.order_id},queryId:l.getOrderId}).data,en=q*M,er=en>0&&en>(R||0)&&U!==l.AssetIssuanceStage.RESERVATION,es=null===(r=C.email)||void 0===r?void 0:r.includes("@jkbx.com"),ea=Object.keys($.errors||{}).length>0||!C.email||!Z.asset_id||void 0===q||es,el=U===l.AssetIssuanceStage.RESERVATION?ea:ea||er;return(0,a.useEffect)(function(){j&&(D(null==X?void 0:X.order_id,(null==ee?void 0:ee.agreement_id)||""),A((0,S.jsx)(I,{}),k))},[j]),(0,a.useEffect)(function(){O&&g(E&&E)},[O]),(0,S.jsxs)("div",{children:[(0,S.jsx)(t.iz,{}),(0,S.jsx)("div",{className:"\n[&>div]:p-0\n",children:(0,S.jsx)("div",{className:"\nlg:w-[400px]\nh-auto\n",children:(0,S.jsxs)("div",{className:"\npy-4\nrelative\nflex\nflex-col\nw-full\nh-full\n",children:[(null===(s=$.errors)||void 0===s?void 0:s.shares)&&(0,S.jsx)("div",{className:B,children:(0,S.jsx)(t.bZ,{message:N("order_card.errors.invalid_shares"),type:"error"})}),er&&(0,S.jsx)("div",{className:B,children:(0,S.jsx)(t.bZ,{markdown:!0,message:N("order_card.errors.portfolio_exceeded"),type:"error"})}),(0,S.jsx)(L,{}),(0,S.jsxs)("div",{className:W,children:[(0,S.jsx)("div",{className:F,children:(0,S.jsx)(t.xv,{color:"gray-4",label:N("order_card.form.share"),type:"p4"})}),(0,S.jsx)("div",{className:"\nw-[140px]\nh-10\nz-basic\n",children:(0,S.jsx)(t.Ki,{id:"shares",min:1,onChange:$.handleChange,onKeyDown:b,placeholder:"",step:1})})]}),(0,S.jsx)("hr",{className:"\nmx-[-4]\nmy-[17.5px]\nh-[1px]\ntext-gray-1\n"}),(0,S.jsxs)("div",{className:W,children:[(0,S.jsxs)("div",{className:F,children:[(0,S.jsx)(t.xv,{color:"gray-4",label:N("order_card.form.price.label"),type:"p4"}),(0,S.jsx)(t.u,{content:N("order_card.form.price.tooltip"),children:(0,S.jsx)("div",{className:"mb-[2px]",children:(0,S.jsx)(t.JO,{color:"gray-4",name:"infoV2",size:"m"})})})]}),(0,S.jsx)("div",{className:F,children:(0,S.jsx)(t.xv,{label:V(M),type:"p3"})})]}),(0,S.jsx)("hr",{className:"\nmx-[-4]\nmy-[17.5px]\nh-[1px]\ntext-gray-2\n"}),(0,S.jsxs)("div",{className:"".concat("\npx-4\nflex\nflex-row\njustify-between\nmb-3\nh-8\n"),children:[(0,S.jsx)("div",{className:F,children:(0,S.jsx)(t.xv,{label:N("order_card.form.total"),type:"p4",weight:"semi-bold"})}),(0,S.jsx)("div",{className:F,children:(0,S.jsx)(t.xv,{label:V(q*M),type:"p3",weight:"semi-bold"})})]}),(0,S.jsx)("div",{className:"\npx-4\nmt-[22px]\nmb-3\n",children:(0,S.jsx)(t.zx,{disabled:el,fullWidth:!0,label:N("order_card.order.button"),loading:Q,onClick:function(){null!=Z&&Z.asset_id&&(T({asset_id:Z.asset_id,current_share_price:M,order_type:Y,shares:q}),U===l.AssetIssuanceStage.RESERVATION&&(0,h.np)("reservationSharesEntered",{artists:(null==Z?void 0:Z.artist)||"",current_share_price:M,productId:Z.asset_id,shares:q,totalPrice:q*M,trackTitle:(null==Z?void 0:Z.song_title)||""}),G({asset_id:J,order_type:Y,shares:q}))}})}),(0,S.jsx)(P,{order:Z,redirect:y,user:C})]})})})]})}}}]);